# HTTP状态码及其含义
---

### 总览

HTTP状态码由三位数字组成，第一位数字定义了响应的类别，后两位没有分类作用。共有5大类：

*   **1xx: 信息性状态码** - 请求已被接收，继续处理。
*   **2xx: 成功状态码** - 请求已成功被服务器接收、理解、并接受。
*   **3xx: 重定向状态码** - 需要客户端采取进一步的操作才能完成请求。
*   **4xx: 客户端错误状态码** - 请求含有语法错误或者无法被执行。
*   **5xx: 服务器错误状态码** - 服务器在处理某个正确请求时发生错误。

---

### 1xx - 信息性状态码

这类状态码在常规Web开发中较少见到，主要用于低层级通信。

*   **100 Continue：**
    *   **含义：** 客户端发送的请求体中包含较大的数据时，会先发送一个带有 `Expect: 100-continue` 头的请求。服务器如果愿意接受这个请求体，就返回100。客户端收到后，再继续发送请求体。
    *   **场景：** 文件上传等大数据量POST请求，用于避免客户端在服务器拒绝时浪费带宽。
*   **101 Switching Protocols：**
    *   **含义：** 客户端请求升级协议（如从HTTP升级到WebSocket），服务器同意升级。
    *   **场景：** 建立WebSocket连接时，在握手阶段会看到这个状态码。
*   **102 Processing：**
    *   **含义：** 服务器已收到并正在处理请求，但尚无响应。
    *   **场景：** 用于处理耗时很长的请求，避免客户端因超时而断开连接。

---

### 2xx - 成功状态码

*   **200 OK：**
    *   **含义：** **请求成功。** 这是最常见的状态码。响应体中包含了所请求的数据。
    *   **细节：** 对于GET请求，资源在响应体中返回；对于POST请求，结果是操作成功的描述或资源本身。

*   **201 Created：**
    *   **含义：** **请求已成功，并因此创建了一个新的资源。** 这通常是在POST或PUT请求之后发送的响应。
    *   **最佳实践：** 响应中应该通过 `Location` 头指明新创建资源的URI。
    *   **场景：** 用户注册成功、创建新文章。

*   **202 Accepted：**
    *   **含义：** **服务器已接受请求，但尚未处理完成。** 请求可能会被处理，也可能不会被处理。
    *   **场景：** 异步任务、需要排队处理的任务。例如，提交一个视频转码请求，服务器立即返回202，表示请求合法已接受，但转码在后台进行。

*   **204 No Content：**
    *   **含义：** **服务器成功处理了请求，但不需要返回任何实体内容。**
    *   **场景：** DELETE请求成功（已删除，无内容可返回）；前端向后台发送一个“已读”状态更新的请求，后台只需确认成功，无需返回数据。

*   **206 Partial Content：**
    *   **含义：** **客户端进行了范围请求，而服务器成功执行了这部分的GET请求。**
    *   **场景：** 视频/音频文件的断点续传、大文件分片下载。响应头中会包含 `Content-Range` 字段，指明返回内容的范围。

---

### 3xx - 重定向状态码

*   **301 Moved Permanently：**
    *   **含义：** **永久重定向。** 请求的资源已被**永久地**移动到新的URI。
    *   **浏览器/搜索引擎行为：** 浏览器会缓存这个重定向关系，下次访问原地址时会直接跳转到新地址，而不再请求原地址。搜索引擎会将权重和排名转移到新的URL。
    *   **场景：** 网站改版，更换域名。

*   **302 Found：**
    *   **含义：** **临时重定向。** 请求的资源**临时地**从不同的URI响应请求。
    *   **浏览器/搜索引擎行为：** 浏览器不会缓存这个关系，下次访问原地址时还会先请求原地址。搜索引擎会继续抓取原地址。
    *   **一个重要的问题（历史包袱）：** 302的原始规范要求重定向后的请求方法**必须不变**（例如POST重定向后还应是POST）。但几乎所有浏览器和客户端都将其实现为**GET**方法。这导致了...
    *   **场景：** 未登录用户访问个人中心，临时重定向到登录页。

*   **303 See Other：**
    *   **含义：** 对应当前请求的响应可以在另一个URI上被找到，而且客户端应当采用**GET**方式访问那个资源。
    *   **作用：** 它明确了302的歧义，**强制**将后续请求变为GET。
    *   **场景：** 在POST请求（如表单提交）后，返回303并重定向到一个“操作成功”的页面，防止用户刷新页面导致表单重复提交。

*   **304 Not Modified：**
    *   **含义：** **资源未改变。** 这是一个用于**缓存**的重定向。客户端发送条件请求（例如带有 `If-Modified-Since` 或 `If-None-Match` 头），如果资源未变更，服务器会返回304，告诉客户端可以直接使用缓存的版本。
    *   **注意：** 它不是一个真正的重定向，因为响应体为空，节省了带宽。
    *   **场景：** 浏览器缓存验证。

*   **307 Temporary Redirect：**
    *   **含义：** **临时重定向。** 与302类似，但**严格要求**重定向后的请求方法和实体不能改变（例如，POST必须仍是POST）。
    *   **场景：** 在需要保证请求方法不变的临时重定向场景下使用，比302更安全、更符合预期。

*   **308 Permanent Redirect：**
    *   **含义：** **永久重定向。** 与301类似，但**严格要求**重定向后的请求方法和实体不能改变。
    *   **场景：** 在需要保证请求方法不变的永久重定向场景下使用。

**小结：**
*   **永久：** 301 (不保方法) vs 308 (保方法)
*   **临时：** 302 (不保方法，事实标准) vs 307 (保方法)
*   **特殊：** 303 (明确转GET) , 304 (缓存)

---

### 4xx - 客户端错误状态码

*   **400 Bad Request：**
    *   **含义：** **请求报文存在语法错误。** 这是一个笼统的错误码。
    *   **场景：** 请求体格式错误（如JSON缺少逗号）、参数类型错误。

*   **401 Unauthorized：**
    *   **含义：** **未经授权。** 请求需要用户的身份认证。
    *   **注意：** 这个名字容易引起误解，它实际指的是“认证”失败，而不是“授权”。更准确的叫法应该是 `Unauthenticated`。
    *   **场景：** 用户未登录，尝试访问需要登录的API；登录时用户名或密码错误。

*   **403 Forbidden：**
    *   **含义：** **服务器理解请求，但拒绝执行。** 与401不同，服务器知道你的身份，但你的身份没有权限访问该资源。
    *   **场景：** 普通用户尝试访问管理员后台。

*   **404 Not Found：**
    *   **含义：** **服务器找不到请求的资源。** 最著名的状态码。
    *   **场景：** 请求了不存在的URL、访问已被删除的文章。

*   **405 Method Not Allowed：**
    *   **含义：** 请求行中指定的请求方法不能被用于请求相应的资源。
    *   **响应头：** 服务器必须返回 `Allow` 头，列出该资源所支持的请求方法（如 `Allow: GET, POST`）。
    *   **场景：** 向一个只接受GET请求的API端点发送了POST请求。

*   **408 Request Timeout：**
    *   **含义：** **请求超时。** 服务器等待客户端发送请求的时间过长。
    *   **场景：** 网络连接慢，客户端未在服务器规定的时间内发送完整个请求。

*   **409 Conflict：**
    *   **含义：** **请求与服务器的当前状态冲突。**
    *   **场景：** 最经典的场景是**版本冲突**。例如，基于文件的版本控制（如Git），两个人同时修改同一个文件；或者使用PUT更新资源时，资源的版本号与服务器上的不匹配。

*   **429 Too Many Requests：**
    *   **含义：** **用户在给定的时间内发送了太多的请求。** 即“限流”或“速率限制”。
    *   **场景：** 防止爬虫、防止暴力破解。响应头中常带有 `Retry-After`，告诉客户端多久后可以重试。

---

### 5xx - 服务器错误状态码

这类错误**责任在服务器端**，需要客户端妥善处理。

*   **500 Internal Server Error：**
    *   **含义：** **服务器遇到了一个未曾预料的状况，导致了它无法完成对请求的处理。** 一个笼统的“万能”错误码。
    *   **场景：** 服务器端代码有Bug（如空指针异常）、数据库连接突然断开。

*   **501 Not Implemented：**
    *   **含义：** **服务器不支持当前请求所需要的某个功能。**
    *   **场景：** 客户端请求了服务器尚未实现的HTTP方法。

*   **502 Bad Gateway：**
    *   **含义：** **作为网关或代理的服务器，从上游服务器收到了一个无效的响应。**
    *   **场景：** 当我们的应用服务器（如Nginx）反向代理到后端的应用服务（如Node.js, Java）时，如果后端服务崩溃、无响应或返回无法理解的内容，Nginx就会返回502。

*   **503 Service Unavailable：**
    *   **含义：** **服务器目前无法使用（由于超载或停机维护）。** 这通常是一个**临时**的状态。
    *   **场景：** 服务器因流量激增而过载；系统正在进行停机维护。响应头中同样可能包含 `Retry-After`。

*   **504 Gateway Timeout：**
    *   **含义：** **作为网关或代理的服务器，未能及时从上游服务器收到响应。**
    *   **场景：** 与502类似，但问题出在**超时**。上游服务器处理时间过长，网关等不及了。

**区分502、503、504：**
*   **502：** 上游服务器返回了“错误的东西”（无效响应）。
*   **503：** 上游服务器明确表示“我现在忙，过会儿再来”。
*   **504：** 上游服务器“太慢了”，网关等不及了。

---

### 总结

1.  **成功类 (2xx)：** 正常处理响应数据。
2.  **重定向类 (3xx)：** 浏览器会自动处理，但要知道301对SEO的影响。在AJAX/Fetch中，默认不自动跟随重定向，需要手动设置 `redirect` 选项。
3.  **客户端错误 (4xx)：**
    *   **400/422:** 通常需要将服务器返回的错误信息展示给用户，告知其如何修正请求。
    *   **401:** 清除本地Token，跳转到登录页。
    *   **403:** 向用户展示“权限不足”的提示。
    *   **404:** 展示友好的“页面未找到”界面。
    *   **429:** 提示用户操作过于频繁，稍后再试。
4.  **服务器错误 (5xx)：**
    *   展示友好的“服务器开小差”错误页面。
    *   对于500/503等错误，可以实现[指数退避算法的重试机制](./指数退避算法的重试机制.md)。

